!function(t){"function"==typeof define&&define.amd?define(["jquery","moment"],t):t(jQuery,moment)}(function(t,e){var n=1e3,i=!1,r=t([]),o=function(){l.resume()},a=function(n,i){var o=n.data("livestampdata");if("number"==typeof i&&(i*=1e3),n.removeAttr("data-livestamp").removeData("livestamp"),i=e(i),e.isMoment(i)&&!isNaN(+i)){var a=t.extend({},{original:n.contents()},o);a.moment=e(i),n.data("livestampdata",a).empty(),r.push(n[0])}},s=function(){i||(l.update(),setTimeout(s,n))},l={update:function(){t("[data-livestamp]").each(function(){var e=t(this);a(e,e.data("livestamp"))});var n=[];r.each(function(){var i=t(this),r=i.data("livestampdata");if(void 0===r)n.push(this);else if(e.isMoment(r.moment)){var o=i.html(),a=r.moment.fromNow();if(o!=a){var s=t.Event("change.livestamp");i.trigger(s,[o,a]),s.isDefaultPrevented()||i.html(a)}}}),r=r.not(n),delete r.prevObject},pause:function(){i=!0},resume:function(){i=!1,s()},interval:function(t){return void 0===t?n:void(n=t)}},c={add:function(n,i){return"number"==typeof i&&(i*=1e3),i=e(i),e.isMoment(i)&&!isNaN(+i)&&(n.each(function(){a(t(this),i)}),l.update()),n},destroy:function(e){return r=r.not(e),e.each(function(){var n=t(this),i=n.data("livestampdata");return void 0===i?e:void n.html(i.original?i.original:"").removeData("livestampdata")}),e},isLivestamp:function(t){return void 0!==t.data("livestampdata")}};t.livestamp=l,t(o),t.fn.livestamp=function(t,e){return c[t]||(e=t,t="add"),c[t](this,e)}});