(function(){!function(t){return"function"==typeof define&&define.amd?define(["jquery"],t):t(window.jQuery)}(function(t){"use strict";var e,i,o,n,a,s,r,l,d,c,h;return c="caret",e=function(){function e(t){this.$inputor=t,this.domInputor=this.$inputor[0]}return e.prototype.setPos=function(){return this.domInputor},e.prototype.getIEPosition=function(){return t.noop()},e.prototype.getPosition=function(){return t.noop()},e.prototype.getOldIEPos=function(){var t,e;return e=r.selection.createRange(),t=r.body.createTextRange(),t.moveToElementText(this.domInputor),t.setEndPoint("EndToEnd",e),t.text.length},e.prototype.getPos=function(){var t,e,i;return(i=this.range())?(t=i.cloneRange(),t.selectNodeContents(this.domInputor),t.setEnd(i.endContainer,i.endOffset),e=t.toString().length,t.detach(),e):r.selection?this.getOldIEPos():void 0},e.prototype.getOldIEOffset=function(){var t,e;return t=r.selection.createRange().duplicate(),t.moveStart("character",-1),e=t.getBoundingClientRect(),{height:e.bottom-e.top,left:e.left,top:e.top}},e.prototype.getOffset=function(){var e,i,o,n;if(d.getSelection&&(o=this.range())){if(o.endOffset-1<0)return null;e=o.cloneRange(),e.setStart(o.endContainer,o.endOffset-1),e.setEnd(o.endContainer,o.endOffset),n=e.getBoundingClientRect(),i={height:n.height,left:n.left+n.width,top:n.top},e.detach()}else r.selection&&(i=this.getOldIEOffset());return i&&!l&&(i.top+=t(d).scrollTop(),i.left+=t(d).scrollLeft()),i},e.prototype.range=function(){var t;return d.getSelection?(t=d.getSelection(),t.rangeCount>0?t.getRangeAt(0):null):void 0},e}(),i=function(){function e(t){this.$inputor=t,this.domInputor=this.$inputor[0]}return e.prototype.getIEPos=function(){var t,e,i,o,n,a,s;return e=this.domInputor,a=r.selection.createRange(),n=0,a&&a.parentElement()===e&&(o=e.value.replace(/\r\n/g,"\n"),i=o.length,s=e.createTextRange(),s.moveToBookmark(a.getBookmark()),t=e.createTextRange(),t.collapse(!1),n=s.compareEndPoints("StartToEnd",t)>-1?i:-s.moveStart("character",-i)),n},e.prototype.getPos=function(){return r.selection?this.getIEPos():this.domInputor.selectionStart},e.prototype.setPos=function(t){var e,i;return e=this.domInputor,r.selection?(i=e.createTextRange(),i.move("character",t),i.select()):e.setSelectionRange&&e.setSelectionRange(t,t),e},e.prototype.getIEOffset=function(t){var e,i,o,n;return i=this.domInputor.createTextRange(),t||(t=this.getPos()),i.move("character",t),o=i.boundingLeft,n=i.boundingTop,e=i.boundingHeight,{left:o,top:n,height:e}},e.prototype.getOffset=function(e){var i,o,n;return i=this.$inputor,r.selection?(o=this.getIEOffset(e),o.top+=t(d).scrollTop()+i.scrollTop(),o.left+=t(d).scrollLeft()+i.scrollLeft(),o):(o=i.offset(),n=this.getPosition(e),o={left:o.left+n.left-i.scrollLeft(),top:o.top+n.top-i.scrollTop(),height:n.height})},e.prototype.getPosition=function(t){var e,i,n,a,s,r;return e=this.$inputor,n=function(t){return t.replace(/</g,"&lt").replace(/>/g,"&gt").replace(/`/g,"&#96").replace(/"/g,"&quot").replace(/\r\n|\r|\n/g,"<br />")},void 0===t&&(t=this.getPos()),r=e.val().slice(0,t),a="<span>"+n(r)+"</span>",a+="<span id='caret'>|</span>",s=new o(e),i=s.create(a).rect()},e.prototype.getIEPosition=function(t){var e,i,o,n,a;return o=this.getIEOffset(t),i=this.$inputor.offset(),n=o.left-i.left,a=o.top-i.top,e=o.height,{left:n,top:a,height:e}},e}(),o=function(){function e(t){this.$inputor=t}return e.prototype.css_attr=["overflowY","height","width","paddingTop","paddingLeft","paddingRight","paddingBottom","marginTop","marginLeft","marginRight","marginBottom","fontFamily","borderStyle","borderWidth","wordWrap","fontSize","lineHeight","overflowX","text-align"],e.prototype.mirrorCss=function(){var e,i=this;return e={position:"absolute",left:-9999,top:0,zIndex:-2e4,"white-space":"pre-wrap"},t.each(this.css_attr,function(t,o){return e[o]=i.$inputor.css(o)}),e},e.prototype.create=function(e){return this.$mirror=t("<div></div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(e),this.$inputor.after(this.$mirror),this},e.prototype.rect=function(){var t,e,i;return t=this.$mirror.find("#caret"),e=t.position(),i={left:e.left,top:e.top,height:t.height()},this.$mirror.remove(),i},e}(),n={contentEditable:function(t){return!(!t[0].contentEditable||"true"!==t[0].contentEditable)}},s={pos:function(t){return t||0===t?this.setPos(t):this.getPos()},position:function(t){return r.selection?this.getIEPosition(t):this.getPosition(t)},offset:function(e){var i,o;return o=this.getOffset(e),l&&(i=t(l).offset(),o.top+=i.top,o.left+=i.left),o}},r=null,d=null,l=null,h=function(t){return l=t,d=t.contentWindow,r=t.contentDocument||d.document},a=function(e,i){var o,n;if(t.isPlainObject(i)&&(n=i.iframe))return e.data("caret-iframe",n),h(n);if(n=e.data("caret-iframe"))return h(n);r=e[0].ownerDocument,d=r.defaultView||r.parentWindow;try{return l=d.frameElement}catch(a){o=a}},t.fn.caret=function(o){var r;return"object"==typeof o?(a(this,o),this):s[o]?(a(this),r=n.contentEditable(this)?new e(this):new i(this),s[o].apply(r,Array.prototype.slice.call(arguments,1))):t.error("Method "+o+" does not exist on jQuery.caret")},t.fn.caret.EditableCaret=e,t.fn.caret.InputCaret=i,t.fn.caret.Utils=n,t.fn.caret.apis=s})}).call(this);