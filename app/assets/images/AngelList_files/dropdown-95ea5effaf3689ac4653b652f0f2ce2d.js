(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};define(["jquery","backbone","underscore"],function(e,n,i){var r;return r=function(){function n(n,i,r){var o;this.toggle=n,this.menu=null!=i?i:e(".menu",this.toggle),this.options=null!=r?r:{},this._position_menu=t(this._position_menu,this),this._respond_to_menu_clicked=t(this._respond_to_menu_clicked,this),this._respond_to_toggle_clicked=t(this._respond_to_toggle_clicked,this),this._hide_menu=t(this._hide_menu,this),o={left:!0,opened_class:"opened",top:!1,over:!1,offset_top:0},this.options=e.extend({},o,this.options)}return n.prototype.bind=function(){return this.menu.length&&this.toggle.length?(this.toggle.on("click",this._respond_to_toggle_clicked),this.menu.on("click",this._respond_to_menu_clicked),e(window).on("resize",this._position_menu),this._position_menu(),this):void 0},n.prototype.unbind=function(){return this.prevent_hide_once=!1,this.toggle.off("click",this._respond_to_toggle_clicked),this.menu.off("click",this._respond_to_menu_clicked),e(window).off("resize",this._position_menu),this._hide_menu(),this},n.hideAll=function(){return this.trigger("hide")},n.prototype._hide_menu=function(){return this.prevent_hide_once||(this.menu.hide(),this.toggle.removeClass(this.options.opened_class),e("body").off("click",this._hide_menu),n.off("hide",this._hide_menu)),this.prevent_hide_once=!1,!0},n.prototype._respond_to_toggle_clicked=function(){return this.toggle.hasClass(this.options.opened_class)||(n.hideAll(),this._position_menu(),this.menu.show(),this.toggle.addClass(this.options.opened_class),this.prevent_hide_once=!0,e("body").on("click",this._hide_menu),n.on("hide",this._hide_menu),n.trigger("show",this)),!0},n.prototype._respond_to_menu_clicked=function(){return this.prevent_hide_once=!0},n.prototype._position_menu=function(){var t,e,n,i,r;return e=this.toggle.position(),r=this.options.top?e.top-this.menu.outerHeight()+(this.options.over?this.toggle.outerHeight():0):e.top+this.options.offset_top+(this.options.over?0:this.toggle.outerHeight()),t=this.options.left?e.left:e.left-this.menu.outerWidth()+this.toggle.outerWidth(),r+=null!=(n=this.options.adjust_top)?n:0,t+=null!=(i=this.options.adjust_left)?i:0,this.menu.css({position:"absolute",top:r,left:t})},n}(),i.extend(r,n.Events)})}).call(this);